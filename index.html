<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AI Smart Glass</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd"></script>
<script src="https://cdn.jsdelivr.net/npm/face-api.js"></script>

<style>
body{
  margin:0;
  background:#0A0A0A;
  color:white;
  font-family:Arial;
}

.screen{display:none;padding:20px;}
.screen.active{display:block;}

.feature{
  padding:15px;
  background:#111827;
  margin:10px 0;
  border-radius:15px;
  cursor:pointer;
}

video{
  width:100%;
  border-radius:15px;
  margin-top:10px;
}

canvas{
  position:absolute;
  top:0;
  left:0;
}

#map{
  width:100%;
  height:300px;
  border-radius:15px;
  margin-top:10px;
}

.mic{
  position:fixed;
  top:15px;
  right:15px;
  width:60px;
  height:60px;
  border-radius:50%;
  background:#22d3ee;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:28px;
}

.mic.active{
  animation:pulse .4s infinite alternate;
}

@keyframes pulse{
  from{box-shadow:0 0 10px #22d3ee;}
  to{box-shadow:0 0 40px #22d3ee;}
}
</style>
</head>

<body>

<div class="mic" id="mic">ðŸŽ¤</div>

<!-- HOME -->
<div id="home" class="screen active">
  <h2>Smart Glass</h2>
  <div class="feature" onclick="openScreen('face')">Face Detection</div>
  <div class="feature" onclick="openScreen('object')">Object Detection</div>
  <div class="feature" onclick="openScreen('currency')">Currency Detection</div>
  <div class="feature" onclick="openScreen('nav')">Navigation</div>
</div>

<!-- FACE -->
<div id="face" class="screen">
  <h2>Face Detection</h2>
  <video id="faceVideo" autoplay></video>
</div>

<!-- OBJECT -->
<div id="object" class="screen">
  <h2>Object Detection</h2>
  <video id="objectVideo" autoplay></video>
</div>

<!-- CURRENCY -->
<div id="currency" class="screen">
  <h2>Currency Detection</h2>
  <video id="currencyVideo" autoplay></video>
</div>

<!-- NAVIGATION -->
<div id="nav" class="screen">
  <h2>Navigation</h2>
  <iframe
    id="map"
    src="https://www.google.com/maps/embed/v1/directions?key=YOUR_GOOGLE_MAPS_API_KEY&origin=Chennai&destination=Shop"
    allowfullscreen>
  </iframe>
</div>

<script>
let stream;
let model;
const mic=document.getElementById("mic");

function speak(text){
  const speech=new SpeechSynthesisUtterance(text);
  speechSynthesis.speak(speech);
}

function openScreen(id){
  stopCamera();
  document.querySelectorAll(".screen")
    .forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");

  if(id==="face") startFace();
  if(id==="object") startObject();
  if(id==="currency") startCurrency();
}

async function startCamera(videoId){
  stream=await navigator.mediaDevices.getUserMedia({video:true});
  document.getElementById(videoId).srcObject=stream;
}

function stopCamera(){
  if(stream){
    stream.getTracks().forEach(t=>t.stop());
  }
}

/* OBJECT DETECTION */
async function startObject(){
  await startCamera("objectVideo");
  model=await cocoSsd.load();
  detectObjects();
}

async function detectObjects(){
  const video=document.getElementById("objectVideo");
  const predictions=await model.detect(video);
  if(predictions.length>0){
    speak("I see "+predictions[0].class);
  }
  requestAnimationFrame(detectObjects);
}

/* FACE DETECTION */
async function startFace(){
  await startCamera("faceVideo");
  await faceapi.nets.tinyFaceDetector.loadFromUri(
    "https://cdn.jsdelivr.net/npm/face-api.js/weights"
  );
  detectFace();
}

async function detectFace(){
  const video=document.getElementById("faceVideo");
  const detection=await faceapi.detectAllFaces(
    video,new faceapi.TinyFaceDetectorOptions()
  );
  if(detection.length>0){
    speak("Face detected");
  }
  requestAnimationFrame(detectFace);
}

/* CURRENCY (Using object model) */
async function startCurrency(){
  await startCamera("currencyVideo");
  model=await cocoSsd.load();
  detectCurrency();
}

async function detectCurrency(){
  const video=document.getElementById("currencyVideo");
  const predictions=await model.detect(video);
  if(predictions.length>0){
    speak("Detected "+predictions[0].class);
  }
  requestAnimationFrame(detectCurrency);
}

/* VOICE CONTROL */
const SpeechRecognition =
window.SpeechRecognition || window.webkitSpeechRecognition;

if(SpeechRecognition){
  const recognition=new SpeechRecognition();
  recognition.continuous=true;
  recognition.onresult=function(e){
    const text=e.results[e.results.length-1][0]
    .transcript.toLowerCase();

    mic.classList.add("active");
    setTimeout(()=>mic.classList.remove("active"),300);

    if(text.includes("home")) openScreen("home");
    if(text.includes("face")) openScreen("face");
    if(text.includes("object")) openScreen("object");
    if(text.includes("currency")) openScreen("currency");
    if(text.includes("navigation")) openScreen("nav");
  };
  recognition.start();
}
</script>

</body>
</html>
